<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<title>Avoid Block Game</title>
<p>
<strong>Instructions: </strong><font color = blue>Use Left and Right Arrow Keys to control the purple block and try to avoid the dropping blue bocks. Have Fun!</font>
</p>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="mturk.js"></script>
<script>
var piecex = 0;
var piecey = 400;
var piecex1 = 0;
var piecey1 = 0;
var piecex2 = 150;
var piecey2 = 0;
var piecex3 = 250;
var piecey3 = 0;
var begin = new Date();
var mask = false;
var time1;
var oDiv;
var money;
function notcollision(piecex,piecex1,piecex2,piecex3,piecey,piecey1,piecey2,piecey3){
   if(mask == true){
    return true;
   }
   if((Math.abs(piecex-piecex1) < 50) && (Math.abs(piecey-piecey1)< 50)){
    return false;
   }
   if((Math.abs(piecex-piecex2) < 50) && (Math.abs(piecey-piecey2)< 50)){
    return false;
   }
   if((Math.abs(piecex-piecex3) < 50) && (Math.abs(piecey-piecey3)< 50)){
    return false;
   }
   return true;
}
$(document).ready(function() {
  var gameboard = $("<div id='gameboard'></div>");
  $(document.body).append(gameboard);
  var piece = $("<div class='piece'></div>");
  $(gameboard).append(piece);
  var piece1 = $("<div class='piece1'></div>");
  var piece2 = $("<div class='piece2'></div>");
  var piece3 = $("<div class='piece3'></div>");
  $(gameboard).append(piece1);
  $(gameboard).append(piece2);
  $(gameboard).append(piece3);
  $(document).keydown(function(e) {
    if(e.keyCode==37) {
      // left arrow clicked
      piecex -= 25;
    } else if(e.keyCode == 39) {
      // right arrow clicked
      piecex += 25;
    }
    if(piecex > 250){
      piecex = 0;
    }
    if(piecex < 0){
      piecex = 250;
    }
    $(".piece").css("left", piecex + "px");
  });
  var si = setInterval(function() {
    var end = new Date();
    var time = end - begin;
    piecey1 += 1 + Math.floor(Math.random()*8);
    var g = 2 + time / 1000;
    if(g < 8){
      piecey2 += g;
    }
    else{
      piecey2 += 8;
    }
    piecey3 += 5;
    if(piecey1 > 400){
      piecey1 = 0;
      piecex1 = Math.floor(Math.random()*250); 
    }
    if(piecey3 == 120){
      piecex3 = Math.floor(Math.random()*250);
    }
    if(piecey2 > 400){
      piecey2 = 0;
      piecex2 = Math.floor(Math.random()*250); 
    }
    if(piecey3 > 400){
      piecey3 = 0;
      piecex3 = Math.floor(Math.random()*250); 
    }
    $(".piece1").css("top", piecey1 + "px");
    $(".piece2").css("top", piecey2 + "px");
    $(".piece3").css("top", piecey3 + "px");
    $(".piece1").css("left", piecex1 + "px");
    $(".piece2").css("left", piecex2 + "px");
    $(".piece3").css("left", piecex3 + "px");
    if(notcollision(piecex,piecex1,piecex2,piecex3,piecey,piecey1,piecey2,piecey3) == false){
        clearInterval(si);
        alert("Game Over! You've earned $"+money);
    }
    time1 = (3600*end.getHours())+(60*end.getMinutes())+end.getSeconds() - begin.getSeconds()-(begin.getMinutes()*60)-(3600*begin.getHours());
    money = (time1 * 0.01).toFixed(2);
    if(money >= 2){
      clearInterval(si);
      alert("Well Down! Your've Earned $2");
    }
    document.all.show.innerHTML = "Time Duration: "+time1+"s"+"  "+"$"+money+"  earned";
  }, 20);
})

</script>
<style>
#gameboard {
  background-color: gray;
  width: 300px;
  height: 450px;
  position: relative;
}
.piece {
  background-color: #AAF;
  width: 50px;
  height: 50px;
  position: absolute;
  left: 0px;
  top: 400px;
}
.piece1 {
  background-color: blue;
  width: 50px;
  height: 50px;
  position: absolute;
  left: 0px;
  top: 0px;
}

.piece2 {
  background-color: blue;
  width: 50px;
  height: 50px;
  position: absolute;
  left: 150px;
  top: 0px;
}

.piece3 {
  background-color: blue;
  width: 50px;
  height: 50px;
  position: absolute;
  left: 250px;
  top: 0px;
}
}
</style>
</head>
<body>
<label id="show"> </label>
</body> 
</html>
